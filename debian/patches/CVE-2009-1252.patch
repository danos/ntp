CVE-2009-1252: Stack-based buffer overflow in the crypto_recv function in 
ntp_crypto.c in ntpd in NTP before 4.2.4p7 and 4.2.5 before 4.2.5p74, when 
OpenSSL and autokey are enabled, allows remote attackers to execute arbitrary 
code via a crafted packet containing an extension field.

--- a/ntpd/ntp_crypto.c
+++ b/ntpd/ntp_crypto.c
@@ -570,7 +570,7 @@ crypto_recv(
 			peer->issuer = emalloc(vallen + 1);
 			strcpy(peer->issuer, peer->subject);
 			temp32 = (fstamp >> 16) & 0xffff;
-			sprintf(statstr,
+			snprintf(statstr, sizeof(statstr),
 			    "flags 0x%x host %s signature %s", fstamp,
 			    peer->subject, OBJ_nid2ln(temp32));
 			record_crypto_stats(&peer->srcadr, statstr);
